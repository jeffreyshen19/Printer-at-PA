/*
 andoverapparel 2017-01-16 
*/
function parseTimeObj(a){var b=a.day,c=a.time,d=timeStr.indexOf(c),e=dayStr.indexOf(b);return 7*d+e}function parseId(a){var b=dayStr[a%7],c=timeStr[Math.floor(a/7)];return{day:b,time:c}}var monthStr=["January","February","March","April","May","June","July","August","September","October","November","December"];$(document).ready(function(){var a=new Date,b=chrono.parseDate("Last Sunday"),c=chrono.parseDate("This Saturday");0===a.getDay()&&(b=chrono.parseDate("Sunday")),6===a.getDay()&&(c=chrono.parseDate("Today"));var d=monthStr[b.getMonth()]+" "+b.getDate(),e="";e+=b.getMonth()==c.getMonth()?c.getDate():monthStr[c.getMonth()]+" "+c.getDate(),$("#date1").text(d),$("#date2").text(e),$.get("/getTimeSlots",function(a){a.forEach(function(a){$("#"+parseTimeObj(a)).removeClass("unfilled").addClass("filled").text(a.email.split("@")[0])})})});var timeStr=["8:00","8:30","9:00","9:30","10:00","10:30","11:00","11:30","12:00","12:30","1:00","1:30","2:00","2:30","3:00","3:30","4:00","4:30","5:00","5:30","6:00","6:30","7:00","7:30","8:00","8:30","9:00"],dayStr=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];$(".unfilled").click(function(a){if(a.target.classList.value.indexOf("unfilled")!=-1){var b=parseId(a.target.id);swal({title:"Almost there...",text:"Enter your Andover email:",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"jdoe@andover.edu",allowOutsideClick:!0,customClass:"popup",confirmButtonColor:"#4ea1d3",confirmButtonText:"Reserve Time"},function(a){if(a===!1)return!1;var c=new RegExp("^[a-zA-Z0-9]+@andover.edu$","g");if(""===a)return swal.showInputError("You need to write something!"),!1;if(!c.test(a))return swal.showInputError("You must use a valid Andover email"),!1;var d={email:a,day:b.day,time:b.time};$.post("/savetime",d,function(a){window.location.pathname="/reserve"}).fail(function(){swal("Oops!","Something went wrong","error")})})}});